<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=1024, user-scalable=no">

  <title>Arduino Cat Faucet</title>

  <!-- Required stylesheet -->
  <link rel="stylesheet" media="screen" href="core/deck.core.css">

  <!-- Extension CSS files go here. Remove or add as needed. -->
  <link rel="stylesheet" media="screen" href="extensions/goto/deck.goto.css">
  <link rel="stylesheet" media="screen" href="extensions/menu/deck.menu.css">
  <link rel="stylesheet" media="screen" href="extensions/navigation/deck.navigation.css">
  <link rel="stylesheet" media="screen" href="extensions/status/deck.status.css">
  <link rel="stylesheet" media="screen" href="extensions/scale/deck.scale.css">

  <!-- Style theme. More available in /themes/style/ or create your own. -->
  <link rel="stylesheet" media="screen" href="themes/style/squarism.css">

  <!-- Transition theme. More available in /themes/transition/ or create your own. -->
  <link rel="stylesheet" media="screen" href="themes/transition/fade.css">

  <!-- Basic black and white print styles -->
  <link rel="stylesheet" media="print" href="core/print.css">

  <!-- Required Modernizr file -->
  <script src="modernizr.custom.js"></script>

  <!-- Syntax highlighting with highlight.js -->
  <link rel="stylesheet" href="highlight.styles/hybrid.css">
  <script src="highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body>
  <div class="deck-container">

    <!-- Begin slides. Just make elements with a class of slide. -->

    <section class="slide">
      <h1>Arduino Cat Faucet</h1>
    </section>

    <section class="slide">
      <img src="images/usa_dc.png" />
    </section>

    <section class="slide">
      <img src="images/usa_pdx.png" />
    </section>

    <section class="slide">
      <br>
      <img style="width:100%;" src="images/nepal_flight.gif" />
    </section>

    <section class="slide">
      <br>
      <img src="images/jones.jpg" />
    </section>

    <section class="slide">
      <br>
      <img src="images/data.jpg" />
    </section>

    <section class="slide">
      <br>
      <img src="images/goonies.jpg" />
    </section>

    <section class="slide">
      <h2>Quit Day Job</h2>
      <p>
        Staycation Numero Uno
        <blockquote class="aside">
        Boss: Ok ... ?!<br>
        *Freak!*
        </blockquote>

        <span class="aside">* Six Weeks Off *</span>
      </p>

      <div class="slide">Opportunity Rose ...</div>

      <div class="slide">
        <p>Staycation Numero Dos</p>
        <span class="aside">
          Habit now<br>
          * Four Weeks Off *
        </span>
      </div>
    </section>

    <section class="slide">
      <br>
      <img src="images/beaker.jpg" />
    </section>

    <section class="slide">
      <h2>The Dream</h2>
      <p>
      Minimum Viable Product<br>
      <span class="aside">My High School Counselor Told Me To Dream Big</span>
        <ul>
          <li>Automatic water - 1 minute every day to think about this.</li>
          <li>Metrics - Is my cat manipulative?</li>
          <li>Temporary - No holes, no vampire taps.</li>
        </ul>
      </p>
    </section>

    <section class="slide">
      <h2>The Dream</h2>
      <h3>How Am I Going To Do This?  :|</h3>
      <img src="images/build/00_the_target.jpg" />
    </section>

    <section class="slide">
      <h2>The Dream</h2>
      <img src="images/build/01_the_dream.jpg" />
      <h4>Notice the eraser</h4>
      <p class="slide">Aside time ...</p>
    </section>

    <section class="slide">
      <h2>Looking at Work</h2>
      <code>$ git rebase -i hard_won_feature</code>
      <br><br>
      <img src="images/edge_of_tomorrow.jpg" />
    </section>

    <section class="slide">
      <h2>Looking at Work</h2>
      <table width="100%">
        <tr>
          <td>Watch final run</td> <td>Watch entire movie</td>
        </tr>
        <tr>
          <td><code>$ git clone<br> $ ls</code></td> <td><code>$ git log</code></td>
        </tr>
      </table>

      <hr>

      <p>Not saying my project is a perfect run.  Just saying this as it applies to retrospectives, repos and code reviews.  Thought it was a good point by Justin Searls at RubyConf 2014.</p>
    </section>

    <section class="slide">
      <h2>Draw, Think, Draw</h2>
      <img src="images/build/02_ir.jpg" />
    </section>

    <section class="slide">
      <h2>Prototype</h2>
      <img src="images/build/03_proto.jpg" />
    </section>

    <section class="slide">
      <h2>Prototype</h2>
      <img src="images/build/04_proto.jpg" />
    </section>

    <section class="slide">
      <h2>Spikes and Questions</h2>
      <ul>
        <li>Spike - Something that detects cats</li>
        <li>Spike - Something that moves the handle</li>
        <li>Torque?</li>
        <li>Precise structure? Fulcrum</li>
        <li>Anchor?</li>
      </ul>
    </section>

    <section class="slide">
      <h2>Microrax</h2>
      <img src="images/build/05_microrax_parts.jpg" />
    </section>

    <section class="slide">
      <h2>Frame Base</h2>
      <img src="images/build/06_frame.jpg" />
    </section>

    <section class="slide">
      <h2>Frame Base</h2>
      <img src="images/build/07_frame_on.jpg" />
    </section>

    <section class="slide">
      <h2>Frame Base</h2>
      <img src="images/build/08_more_frame.jpg" />
      <h3>My anchor question would be answered and I didn't know it (BDUF)</h3>
    </section>

    <section class="slide">
      <h2>Building Up</h2>
      <h4>3D is hard.  8 beams, 15 angles.</h4>
      <img src="images/build/09_building_up.jpg" />
    </section>

    <section class="slide">
      <h2>Servo Mount Bracket</h2>
      <img src="images/build/10_servo_mount.jpg" />
    </section>

    <section class="slide">
      <h2>$ cap deploy</h2>
      <img src="images/build/11_first_deploy.jpg" />
    </section>

    <section class="slide">
      <h2>$ cap deploy</h2>
      <img src="images/build/12_first_deploy_angle.jpg" />
    </section>

    <section class="slide">
      <h2>Physics</h2>
      <h4>Maybe obvious to some but I had to think about this one</h4>
      <img src="images/build/13_physics.jpg" />
    </section>

    <section class="slide">
      <h2>I need an arm</h2>
      <h4>Servo gear is just a star with holes</h4>
      <img src="images/build/14_adapter_parts.jpg" />
    </section>

    <section class="slide">
      <h2>Servo Arm</h2>
      <img src="images/build/15_servo_to_micro.jpg" />
    </section>

    <section class="slide">
      <h2>Servo Arm</h2>
      <img src="images/build/16_servo_hack.jpg" />
    </section>

    <section class="slide">
      <h2>Servo Arm</h2>
      <img src="images/build/17_servo_arm.jpg" />
    </section>

    <section class="slide">
      <h2>Servo Arm</h2>
      <img src="images/build/18_servo_over.jpg" />
    </section>

    <section class="slide">
      <h2>Action Grip Fail</h2>
      <h5>Velcro also had no power in this evil sink domain.</h5>
      <img src="images/build/19_grip_fail.jpg" />
    </section>

    <section class="slide">
      <h2>Action Grip!</h2>
      <img src="images/build/19_grip_ok.jpg" />
    </section>

    <section class="slide">
      <h2>Ruby Talk?</h2>
      <h3 class="aside">Ok, that's the hardware thing.</h3>
      <ul>
        <li class="slide">Need code to detect cats, move arm</li>
        <li class="slide">Need communication</li>
        <li class="slide">API and software stuff.  Easy!</li>
        <li class="slide">We need roflscale database immediately.<br>
        <span class="aside">2 requests per day ≈</span><br>
        <span class="aside">0.00002364066 requests / sec</span>
        </li>
        <li class="slide">MongoDB or possibly a 1.7 billion node hadoop cluster</li>
        <li class="slide">Architecture Time!</li>
      </ul>
    </section>

    <section class="slide">
      <h4>Señor Software Engineer?</h4>

      <blockquote class="aside">
        No.
        Ingeniero Principal de Los Grifos de Gatos.
      </blockquote>
        <img src="images/software/architecture.png" />
      </p>
    </section>


    <section class="slide">
      <h2>Arduino Shields</h2>
      <h4>XBee Shield for communication problem</h4>
      <img src="images/arduino_shields.jpg" />
    </section>

    <section class="slide">
      <h2>XBee - p2p wireless auto config chip</h2>
      <img src="images/xbee.jpg" />
    </section>

    <section class="slide">
      <h2>JSON over XBee Serial</h2>
      <pre><code class="json">// example JSON message
{
  "sensor": "sinks",
  "name": "basement",
  "proximity": "true",
  "running": "true",
  "hash": "82C61D54A77D6A90219E4E40CE6C8440",
  "type": "metric"
}</code></pre>
    </section>

    <section class="slide">
      <h2>Serial Problems</h2>
      <ul>
        <li class="slide">No TCP.  Checksum.  But ...</li>
        <li class="slide">MD5 contrib lib worked --> time --> crash</li>
        <li class="slide">Reading JSON off serial was weird ...</li>
      </ul>
    </section>

    <section class="slide">
      <h2>Awkward Apology First</h2>
      <small>A long time ago, Rails 3.0.3.  Macports?  Leopard?</small>
      <p>There are three types of code in the world:</p>
      <ol>
        <li class="slide">Code you don't want anyone to see.</li>
        <li class="slide">Code you refactored and it's ok for someone to see.</li>
        <li class="slide">Textbook quality code you emboss your shoes with so when you walk you leave beautiful footprints.</li>
      </ol>

      <p class="slide">This is #1 so I never, never, never want to present it or share it.<br>
      Here's the repo: <code>github.com/squarism/cat_faucet</code></p>
    </section>

    <section class="slide">
      <h2>Serial Reading</h2>
      <em>github.com/squarism/cat_faucet</em>
      <pre>
        <code class="ruby">require 'serialport'
require 'json'
...

sp = SerialPort.new(...)  # options
start_json = false
while true do
  c = sp.getc

  if c == "{" && !start_json
    start_json = true
    json_buffer = c
  else
    if c != "}"
      json_buffer += c
    end

    if c == "}"
      json_buffer += c
      json_string = json_buffer
      # parse ...</code>
      </pre>
    </section>

    <section class="slide">
      <h2>Serial In Action</h2>
      <pre>
VALID: &lt;metric&gt;, proximity:0 running:false
Posting to http://localhost:3000/sinks/ -->
{"sensor"=>"sinks", "name"=>"basement",
  "proximity"=>"0", "running"=>"false", "type"=>"metric"}
Response 200 OK : mapped json_request.
      </pre>
    </section>

    <section class="slide">
      <h2>Serial Fail</h2>
      <p>If I had to do it again ...</p>
      <ol>
        <li>Use a binary protocol.  JSON is for the web.</li>
        <li>"Ruby developer goes embeddded" mistakes.</li>
        <li>Instead of looking for {} characters, use state machine style</li>
      </ol>
      <pre><code class="ruby">brace_count += 1 if character == "{"
brace_count -= 1 if character == "}"
JSON.parse(buffer) if brace_count == 0</code></pre>
      <p>Because my lame attempt can't do embedded docs</p>
    </section>

    <section class="slide">
      <h2>Arduino Box</h2>
      <img src="images/build/20_arduino.jpg" />
    </section>

    <section class="slide">
      <h2>Hook Up the I/O</h2>
      <img src="images/build/21_hook_up.jpg" />
    </section>

    <section class="slide">
      <h2>Hide the Implementation</h2>
      <span class="aside">Infrared sensor not pictured</span>
      <img src="images/build/22_clean_up.jpg" />
    </section>

    <section class="slide">
      <h2>Demo</h2>
      <iframe width="800" height="460" src="http://www.youtube.com/embed/J5ToTB8yRJk" frameborder="0" allowfullscreen></iframe>
    </section>

    <section class="slide">
      <h2>Mongoid Versioning</h2>
      <img src="images/software/mongoid.png" />
      <pre>
> Sink.first.plot_by_hours
=> [[23, 20.0], [22, 40.0], [18, 40.0]]
      </pre>
    </section>

   <section class="slide">
      <h2>Versioning</h2>
      <pre><code class="json">
{ "_id" : ObjectId("..."),
  "collected_at" : "Tue Mar 01 2011",
  "created_at" : "Wed Feb 16 2011",
  "name" : "basement",
  "proximity" : false,
  "running" : false,
  "updated_at" : "Fri Mar 04 2011",
  "version" : 5,
  "versions" : [
  {
    "version" : 1,
    "collected_at" : "Wed Feb 16 2011",
    "created_at" : "Wed Feb 16 2011",
    "name" : "basement",
    "proximity" : false,
    "running" : false,
    "updated_at" : "Wed Feb 16 2011",
    "_id" : ObjectId("...")
  },
      </code></pre>
    </section>

    <section class="slide">
      <h2>Rails</h2>
      <img src="images/software/rails_1.png" />
    </section>

    <section class="slide">
      <h2>Iterate</h2>
      <img src="images/software/rails_2.png" />
    </section>

    <section class="slide">
      <h2>Metrics</h2>
      <p>Fnordmetrics</p>
      <img src="images/software/fnordmetric_30_days.png" />
    </section>

    <section class="slide">
      <h1>Problems</h1>
    </section>

    <section class="slide">
      <h2>Problems</h2>
      <ul>
        <li class="slide">Servo Buzzing - <code>servo.detach();</code></li>
        <li class="slide">Frame Torque</li>
        <li class="slide">Flot (my Rails app)
          <ul>
            <li>Silent JS errors</li>
            <li>Data format</li>
          </ul>
        </li>
        <li class="slide">Linux
          <ul>
            <li>Yak shaving RAID, dist-upgrade</li>
            <li>Kernel revision fixes serial but breaks networking after scp of 90MB?</li>
            <li>dkms upgrades ... eventually linux stable had both fixes in</li>
          </ul>
        </li>
      </ul>
    </section>

    <section class="slide">
      <h1>Reaction</h1>
    </section>

    <section class="slide">
      <h2>Reaction</h2>
      <img src="images/reaction/hackaday.png" />
    </section>

    <section class="slide">
      <h2>Reaction</h2>
      <img src="images/reaction/sparkfun.png" />
    </section>

    <section class="slide">
      <h2>Reaction</h2>
      <img src="images/reaction/adafruit.png" />
    </section>

    <section class="slide">
      <h2>Reaction</h2>
      <img src="images/reaction/blog_comments.png" />
    </section>

    <section class="slide">
      <h2>Reaction</h2>
      <img src="images/reaction/newsgroup.png" />
    </section>

    <section class="slide">
      <h2>Science Fair!</h2>
      <img src="images/reaction/work.jpg" />
    </section>

    <section class="slide">
      <h2>A Thing</h2>
      <img src="images/reaction/aed.jpg" />
    </section>

    <section class="slide">
      <h2>Myself</h2>
      <ul>
        <li>Firmware</li>
        <li>Long Lived - 4 years!</li>
        <li>Cat Behavior Learned ... bye DIY Rails app</li>
        <li>Much learning, many insight</li>
      </ul>
    </section>

    <section class="slide">
      <h2>Insight</h2>
      <blockquote>
        from one thing, know ten thousand things
      </blockquote>
      ― Miyamoto Musashi, The Book of Five Rings
    </section>

    <section class="slide">
      <h2>Ten Thousand Things</h2>
      <ul>
        <li class="slide">Arduino memory (C, chip).  Run away!</li>
        <li class="slide">Microrax adjusts - so it's 1/16" forgiving</li>
        <li class="slide">Microrax: order extra bolts, back-plates and joint pieces</li>
        <li class="slide">Servo torque changes with voltage</li>
        <li class="slide">Installation is tricky. Don't be afraid to change your design.  Iterate.</li>
        <li class="slide">Don't over-engineer or favor tools (mongo)</li>
    </section>

    <section class="slide">
      <h2>Ten Thousand Things - Don't Worry Almost Over</h2>
      <ul>
        <li class="slide">Hardware Hacking is so fun to share you guys!</li>
        <li class="slide">Physical Deployment is weird you guys (it's not cap deploy!)</li>
        <li class="slide">Hardware <code>¯\_(ツ)_/¯</code> &nbsp;&nbsp;&nbsp; Software <code>&lt;3 &lt;3 &lt;3</code></li>
        <li class="slide">Let dead code go, it's ok, you learned something</li>
      </ul>
    </section>

    <section class="slide">
      <h2>Biggest Insight</h2>
      <p class="slide">
        Contiguous blocks of time for thinking is solid gold.
      </p>
    </section>

    <section class="slide">
      <h2>Thanks</h2>

      <div style="float:right">
        <a href="https://www.sparkfun.com/">Sparkfun</a><br>
        <a href="https://www.adafruit.com/">Adafruit</a><br>
        <a href="http://www.microrax.com/">Microrax</a><br>
        <hr>
        <p><code>@squarism</code></p>
        <a href="http://squarism.com/2011/03/10/arduino-cat-faucet-with-mongodb-and-rails/">Blog Post</a><br>
        <a href="https://github.com/squarism/cat_faucet">github.com/squarism/cat_faucet</a>
      </div>

      <div style="float:left">
        <img style="height:400px;" src="images/jones.jpg" />
      </div>

    </section>

    <!-- End slides. -->

    <!-- Begin extension snippets. Add or remove as needed. -->

    <!-- deck.navigation snippet -->
    <!--
    <div aria-role="navigation">
      <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
      <a href="#" class="deck-next-link" title="Next">&#8594;</a>
    </div>
     -->

    <!-- deck.status snippet -->
    <!--
    <p class="deck-status" aria-role="status">
      <span class="deck-status-current"></span> /
      <span class="deck-status-total"></span>
    </p>
    -->

    <!-- deck.goto snippet -->
    <form action="." method="get" class="goto-form">
      <label for="goto-slide">Go to slide:</label>
      <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
      <datalist id="goto-datalist"></datalist>
      <input type="submit" value="Go">
    </form>

    <!-- End extension snippets. -->
  </div>

<!-- Required JS files. -->
<script src="jquery.min.js"></script>
<script src="core/deck.core.js"></script>

<!-- Extension JS files. Add or remove as needed. -->
<script src="extensions/menu/deck.menu.js"></script>
<script src="extensions/goto/deck.goto.js"></script>
<script src="extensions/status/deck.status.js"></script>
<script src="extensions/navigation/deck.navigation.js"></script>
<script src="extensions/scale/deck.scale.js"></script>

<!-- Initialize the deck. You can put this in an external file if desired. -->
<script>
  $(function() {
    $.deck('.slide');
  });
</script>
</body>
</html>
